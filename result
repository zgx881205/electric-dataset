C:\ProgramData\Anaconda3\envs\kgin\python.exe D:\原版未改动\code_graph\src\main.py
[2024-05-20 21:36:57,766] INFO: ================== preparing data ===================
[2024-05-20 21:36:57,766] INFO: load rating file: ../data/electric/ratings_final.npy
[2024-05-20 21:36:57,767] INFO: splitting dataset to 6:2:2 ...
[2024-05-20 21:36:57,769] INFO: contructing users' initial entity set ...
[2024-05-20 21:36:57,778] INFO: contructing items' initial entity set ...
rating_np
[[  0 276   1]
 [  0 517   1]
 [  0 118   1]
 ...
 [ 76 595   0]
 [ 76 964   0]
 [ 76 634   0]]
[2024-05-20 21:36:57,820] INFO: loading kg file: ../data/electric/kg_final.npy
[2024-05-20 21:36:57,821] INFO: constructing knowledge graph ...
[2024-05-20 21:36:57,842] INFO: contructing users' kg triple sets ...
[2024-05-20 21:36:57,847] INFO: contructing items' kg triple sets ...
[2024-05-20 21:36:57,996] INFO: load rating file: ../data/electric/ratings_final.npy
[2024-05-20 21:36:57,996] INFO: splitting dataset to 6:2:2 ...
[2024-05-20 21:36:57,999] INFO: contructing users' initial entity set ...
rating_np
[[  0 276   1]
 [  0 517   1]
 [  0 118   1]
 ...
 [ 76 595   0]
 [ 76 964   0]
 [ 76 634   0]]
[2024-05-20 21:36:58,007] INFO: contructing items' initial entity set ...
torch.Size([77, 64])
[2024-05-20 21:36:58,491] INFO: ================== training CKAN ====================
[2024-05-20 21:37:04,087] INFO: Step 1/10, Loss: 0.698869526386261
[2024-05-20 21:37:04,967] INFO: Step 1/10, Loss: 0.6940972805023193
[2024-05-20 21:37:05,682] INFO: Step 1/10, Loss: 0.6892006397247314
[2024-05-20 21:37:06,168] INFO: Step 1/10, Loss: 0.6869790554046631
[2024-05-20 21:37:06,612] INFO: Step 1/10, Loss: 0.6841700673103333
[2024-05-20 21:37:07,077] INFO: Step 1/10, Loss: 0.6789343953132629
[2024-05-20 21:37:07,545] INFO: Step 1/10, Loss: 0.6760374307632446
[2024-05-20 21:37:08,035] INFO: Step 1/10, Loss: 0.6730480194091797
[2024-05-20 21:37:09,035] INFO: Step 1/10, Loss: 0.6679612398147583
[2024-05-20 21:37:10,347] INFO: Step 1/10, Loss: 0.6640814542770386
[2024-05-20 21:37:11,469] INFO: epoch 00    eval auc: 0.9621 f1: 0.8089    test auc: 0.9606 f1: 0.8158
[2024-05-20 21:38:16,564] INFO: K@5:0.0246  K@10:0.0566  K@20:0.1475  K@50:0.3563  K@100:0.6821
[2024-05-20 21:38:18,176] INFO: Step 2/10, Loss: 0.657321572303772
[2024-05-20 21:38:19,561] INFO: Step 2/10, Loss: 0.6534470319747925
[2024-05-20 21:38:20,963] INFO: Step 2/10, Loss: 0.6491450667381287
[2024-05-20 21:38:22,235] INFO: Step 2/10, Loss: 0.6414733529090881
[2024-05-20 21:38:23,536] INFO: Step 2/10, Loss: 0.6380150318145752
[2024-05-20 21:38:24,880] INFO: Step 2/10, Loss: 0.6338835954666138
[2024-05-20 21:38:26,363] INFO: Step 2/10, Loss: 0.6269763708114624
[2024-05-20 21:38:27,623] INFO: Step 2/10, Loss: 0.6236491799354553
[2024-05-20 21:38:28,549] INFO: Step 2/10, Loss: 0.6157613396644592
[2024-05-20 21:38:29,111] INFO: Step 2/10, Loss: 0.6098726987838745
[2024-05-20 21:38:29,443] INFO: epoch 01    eval auc: 0.9752 f1: 0.8280    test auc: 0.9721 f1: 0.8376
[2024-05-20 21:39:09,057] INFO: K@5:0.0416  K@10:0.0710  K@20:0.1435  K@50:0.3715  K@100:0.7602
[2024-05-20 21:39:09,645] INFO: Step 3/10, Loss: 0.6000727415084839
[2024-05-20 21:39:10,098] INFO: Step 3/10, Loss: 0.5941061973571777
[2024-05-20 21:39:10,546] INFO: Step 3/10, Loss: 0.5929743051528931
[2024-05-20 21:39:11,057] INFO: Step 3/10, Loss: 0.584261953830719
[2024-05-20 21:39:11,538] INFO: Step 3/10, Loss: 0.578826904296875
[2024-05-20 21:39:12,060] INFO: Step 3/10, Loss: 0.5712148547172546
[2024-05-20 21:39:12,589] INFO: Step 3/10, Loss: 0.5656353235244751
[2024-05-20 21:39:13,140] INFO: Step 3/10, Loss: 0.5551016330718994
[2024-05-20 21:39:13,808] INFO: Step 3/10, Loss: 0.546616792678833
[2024-05-20 21:39:14,226] INFO: Step 3/10, Loss: 0.5316044092178345
[2024-05-20 21:39:14,422] INFO: epoch 02    eval auc: 0.9773 f1: 0.7998    test auc: 0.9736 f1: 0.8036
[2024-05-20 21:39:45,007] INFO: K@5:0.0438  K@10:0.0777  K@20:0.1565  K@50:0.3537  K@100:0.7754
[2024-05-20 21:39:45,596] INFO: Step 4/10, Loss: 0.5297349691390991
[2024-05-20 21:39:46,036] INFO: Step 4/10, Loss: 0.5361258387565613
[2024-05-20 21:39:46,503] INFO: Step 4/10, Loss: 0.509312629699707
[2024-05-20 21:39:47,039] INFO: Step 4/10, Loss: 0.5169607996940613
[2024-05-20 21:39:47,593] INFO: Step 4/10, Loss: 0.5086109638214111
[2024-05-20 21:39:48,178] INFO: Step 4/10, Loss: 0.5045113563537598
[2024-05-20 21:39:48,772] INFO: Step 4/10, Loss: 0.4964986741542816
[2024-05-20 21:39:49,437] INFO: Step 4/10, Loss: 0.4863817095756531
[2024-05-20 21:39:50,100] INFO: Step 4/10, Loss: 0.48060160875320435
[2024-05-20 21:39:50,648] INFO: Step 4/10, Loss: 0.483597069978714
[2024-05-20 21:39:51,031] INFO: epoch 03    eval auc: 0.9792 f1: 0.8203    test auc: 0.9756 f1: 0.8359
[2024-05-20 21:40:23,235] INFO: K@5:0.0397  K@10:0.0818  K@20:0.1549  K@50:0.3676  K@100:0.7907
[2024-05-20 21:40:23,808] INFO: Step 5/10, Loss: 0.46758854389190674
[2024-05-20 21:40:24,301] INFO: Step 5/10, Loss: 0.4603605270385742
[2024-05-20 21:40:24,905] INFO: Step 5/10, Loss: 0.4531819522380829
[2024-05-20 21:40:25,358] INFO: Step 5/10, Loss: 0.45516467094421387
[2024-05-20 21:40:25,831] INFO: Step 5/10, Loss: 0.4419173300266266
[2024-05-20 21:40:26,274] INFO: Step 5/10, Loss: 0.41926753520965576
[2024-05-20 21:40:26,745] INFO: Step 5/10, Loss: 0.43404847383499146
[2024-05-20 21:40:27,317] INFO: Step 5/10, Loss: 0.42519283294677734
[2024-05-20 21:40:27,829] INFO: Step 5/10, Loss: 0.4152987003326416
[2024-05-20 21:40:28,303] INFO: Step 5/10, Loss: 0.4262602925300598
[2024-05-20 21:40:28,648] INFO: epoch 04    eval auc: 0.9818 f1: 0.8496    test auc: 0.9783 f1: 0.8658
[2024-05-20 21:41:00,086] INFO: K@5:0.0401  K@10:0.0753  K@20:0.1485  K@50:0.3834  K@100:0.8081
[2024-05-20 21:41:00,621] INFO: Step 6/10, Loss: 0.39585044980049133
[2024-05-20 21:41:01,072] INFO: Step 6/10, Loss: 0.40054982900619507
[2024-05-20 21:41:01,519] INFO: Step 6/10, Loss: 0.40566128492355347
[2024-05-20 21:41:01,977] INFO: Step 6/10, Loss: 0.3783159852027893
[2024-05-20 21:41:02,562] INFO: Step 6/10, Loss: 0.3780116140842438
[2024-05-20 21:41:03,138] INFO: Step 6/10, Loss: 0.37967926263809204
[2024-05-20 21:41:03,722] INFO: Step 6/10, Loss: 0.37392979860305786
[2024-05-20 21:41:04,258] INFO: Step 6/10, Loss: 0.3766694664955139
[2024-05-20 21:41:04,892] INFO: Step 6/10, Loss: 0.3714262843132019
[2024-05-20 21:41:05,510] INFO: Step 6/10, Loss: 0.3574357330799103
[2024-05-20 21:41:05,846] INFO: epoch 05    eval auc: 0.9832 f1: 0.8581    test auc: 0.9807 f1: 0.8784
[2024-05-20 21:41:35,185] INFO: K@5:0.0454  K@10:0.0734  K@20:0.1428  K@50:0.3912  K@100:0.8167
[2024-05-20 21:41:35,785] INFO: Step 7/10, Loss: 0.35243573784828186
[2024-05-20 21:41:36,343] INFO: Step 7/10, Loss: 0.3463917374610901
[2024-05-20 21:41:36,893] INFO: Step 7/10, Loss: 0.33698007464408875
[2024-05-20 21:41:37,550] INFO: Step 7/10, Loss: 0.33089137077331543
[2024-05-20 21:41:37,977] INFO: Step 7/10, Loss: 0.32672351598739624
[2024-05-20 21:41:38,401] INFO: Step 7/10, Loss: 0.3369762599468231
[2024-05-20 21:41:38,887] INFO: Step 7/10, Loss: 0.3463997542858124
[2024-05-20 21:41:39,341] INFO: Step 7/10, Loss: 0.33150482177734375
[2024-05-20 21:41:39,876] INFO: Step 7/10, Loss: 0.3145187795162201
[2024-05-20 21:41:40,335] INFO: Step 7/10, Loss: 0.32994601130485535
[2024-05-20 21:41:40,619] INFO: epoch 06    eval auc: 0.9843 f1: 0.8607    test auc: 0.9828 f1: 0.8793
[2024-05-20 21:42:10,253] INFO: K@5:0.0449  K@10:0.0726  K@20:0.1452  K@50:0.4016  K@100:0.8223
[2024-05-20 21:42:10,822] INFO: Step 8/10, Loss: 0.3090832829475403
[2024-05-20 21:42:11,258] INFO: Step 8/10, Loss: 0.29399409890174866
[2024-05-20 21:42:11,775] INFO: Step 8/10, Loss: 0.3062220811843872
[2024-05-20 21:42:12,350] INFO: Step 8/10, Loss: 0.294220507144928
[2024-05-20 21:42:12,915] INFO: Step 8/10, Loss: 0.2919934093952179
[2024-05-20 21:42:13,495] INFO: Step 8/10, Loss: 0.2880883812904358
[2024-05-20 21:42:14,075] INFO: Step 8/10, Loss: 0.3122809827327728
[2024-05-20 21:42:14,739] INFO: Step 8/10, Loss: 0.29739123582839966
[2024-05-20 21:42:15,169] INFO: Step 8/10, Loss: 0.29163727164268494
[2024-05-20 21:42:15,588] INFO: Step 8/10, Loss: 0.29389113187789917
[2024-05-20 21:42:15,777] INFO: epoch 07    eval auc: 0.9854 f1: 0.8687    test auc: 0.9841 f1: 0.8835
[2024-05-20 21:42:46,079] INFO: K@5:0.0452  K@10:0.0709  K@20:0.1472  K@50:0.4147  K@100:0.8346
[2024-05-20 21:42:46,644] INFO: Step 9/10, Loss: 0.2750949263572693
[2024-05-20 21:42:47,107] INFO: Step 9/10, Loss: 0.29007142782211304
[2024-05-20 21:42:47,775] INFO: Step 9/10, Loss: 0.2866000235080719
[2024-05-20 21:42:48,205] INFO: Step 9/10, Loss: 0.269153892993927
[2024-05-20 21:42:48,639] INFO: Step 9/10, Loss: 0.26660624146461487
[2024-05-20 21:42:49,075] INFO: Step 9/10, Loss: 0.262545645236969
[2024-05-20 21:42:49,575] INFO: Step 9/10, Loss: 0.2666444182395935
[2024-05-20 21:42:50,051] INFO: Step 9/10, Loss: 0.2530415654182434
[2024-05-20 21:42:50,602] INFO: Step 9/10, Loss: 0.24471142888069153
[2024-05-20 21:42:51,112] INFO: Step 9/10, Loss: 0.2602171301841736
[2024-05-20 21:42:51,478] INFO: epoch 08    eval auc: 0.9860 f1: 0.8756    test auc: 0.9853 f1: 0.8869
[2024-05-20 21:43:23,089] INFO: K@5:0.0433  K@10:0.0729  K@20:0.1502  K@50:0.4142  K@100:0.8398
[2024-05-20 21:43:23,610] INFO: Step 10/10, Loss: 0.2698175609111786
[2024-05-20 21:43:24,105] INFO: Step 10/10, Loss: 0.2538590729236603
[2024-05-20 21:43:24,646] INFO: Step 10/10, Loss: 0.23580694198608398
[2024-05-20 21:43:25,155] INFO: Step 10/10, Loss: 0.23868751525878906
[2024-05-20 21:43:25,664] INFO: Step 10/10, Loss: 0.24323752522468567
[2024-05-20 21:43:26,309] INFO: Step 10/10, Loss: 0.2336517870426178
[2024-05-20 21:43:26,734] INFO: Step 10/10, Loss: 0.2476288378238678
[2024-05-20 21:43:27,156] INFO: Step 10/10, Loss: 0.22679394483566284
[2024-05-20 21:43:27,601] INFO: Step 10/10, Loss: 0.23441794514656067
[2024-05-20 21:43:28,019] INFO: Step 10/10, Loss: 0.24448861181735992
[2024-05-20 21:43:28,269] INFO: epoch 09    eval auc: 0.9870 f1: 0.8809    test auc: 0.9861 f1: 0.8944
[2024-05-20 21:43:59,785] INFO: K@5:0.0427  K@10:0.0762  K@20:0.1543  K@50:0.4295  K@100:0.8520

Process finished with exit code 0
